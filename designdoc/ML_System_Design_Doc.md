# ML System Design Doc - [RU]
## Дизайн ML системы - Shiawase v2


### 0. Meta
- Разные разделы этого документа написаны от лица 2х "персонажей":
  1. Product Owner - `PO` - Yumenoya - вымышленная компания, которая с помощью python-стека анализирует свойства квартиры и пытается оценить ее стоимость
  2. Data Scientist - `DS` - Борис, Влад, Даниил
- MVP #1 - фактически одна большая фаза discovery и не предполагает внедрения и удобного UI
- *Сделано по Шаблону ML System Design Doc от телеграм-канала [Reliable ML](https://t.me/reliable_ml)*
### 1. Цели и предпосылки 
#### 1.1. Зачем идем в разработку продукта?  

- Бизнес-цель `PO`:

Сократить время и усилия, затрачиваемые на анализ 
цены квартиры и предложение цены на основе имеющихся данных.
- Почему станет лучше, чем сейчас, от использования ML `Product Owner` & `Data Scientist`:

Уменьшение рутинных операций, уменьшение задержки между оценкой квартиры и результатов оценки, актуальность, доступность(например с телефона), быстрое реагирование на изменение рынка.
- Что будем считать успехом итерации с точки зрения бизнеса `Product Owner`  

Инструмент, который позволяет в течение пары минут получить адекватную стоимость квартиры.  

#### 1.2. Бизнес-требования и ограничения  
Текущий бизнес-процесс: 

1. оценщик внимательно изучает характеристики квартиры и по ходу изменяет ее стоимость в зависимости от данных
2. после окончания оценки квартиры собирает необходимые данные и проверяет инфраструктуру района
3. на основе двух предыдущих шагов предлагает адекватную стоимость квартиры

Бизнес-процесс после окончания данной итерации (он же основной use case):
1. запускает Инструмент, который выдаёт 
    - потенциальную стоимость квартиры и причины почему она так стоит.
2. оценщик резюмирует и понятно доносит причины такой стоимости квартир (возможно проведя доп. анализ\валидацию вручную)


* Бизнес-ограничения `PO`:
    * поддержание инфраструктуры проекта обходится меньше, чем в $50\мес.
    * время работы скрипта - не более 1 часа
    * (опционально) прозрачность того, какой именно срез исторических данных был использован для каждой стоимости
* Критерии успеха `PO`: на дистанции в 1 месяц применение скрипта позволяет правильно оценить стоимость намного больше, чем от ручного труда с минимальной ручной доработкой
 
#### 1.3. Что входит в скоуп проекта/итерации, что не входит   

* На закрытие каких БТ подписываемся в данной итерации `DS`: 
  * создание пайплайна данных
  * определение алгоритмов правильного расчета стоимости
  * генерация причин такой стоимости*
  * создание инструмента для запуска с минималистичным UI   
- Что не будет закрыто `DS`: 
  - доказательство корректности выдаваемой ценны  
  - возможность выбора временного периода
- Описание результата с точки зрения качества кода и воспроизводимости решения `DS`: код разбит на функциональные модули (сбор данных, генерация стоимости и причин), модели\алгоритмы версионируются  
- Описание планируемого технического долга (что оставляем для дальнейшей продуктивизации) `DS`: более удобный UI, развёрнутая документация

#### 1.4. Предпосылки решения  

- есть открытые данные на cian/avito
- простой линейной регрессии будет достаточно для создания MVP
- наличие открытых датасетов и науч. работ по ним по теме предсказание цены на именно нужных нам данных: 
  - https://www.kaggle.com/c/mlurfuflat
  - https://www.kaggle.com/datasets/yasserh/housing-prices-dataset

### 2. Методология `Data Scientist`     

#### 2.1. Постановка задачи  

- Решение задачи регрессии
- интерпретация результата
- (опционально) оптимизация модели  

#### 2.2. Блок-схема решения  

- _Будет позже_

#### 2.3. Этапы решения задачи `Data Scientist`  

###### Этап 1. Сбор данных
На основе cian/avito собираем в БД все возможно полезные данные

Примечание: парсеры не требует особых прав\креденшиалов


###### Этап 2. ...

### 3. Подготовка пилота  
  
#### 3.1. Способ оценки пилота  
  
Пилот:
- на промежутке в 1 неделю после каждой оценки стоимости вручную запускается скрипт и сохраняются его результаты
- результаты просматриваются вручную `PO` для проверки причин и стоимости
- Краткое описание предполагаемого дизайна и способа оценки пилота `Product Owner`, `Data Scientist` with `AB Group` 
  
#### 3.2. Что считаем успешным пилотом  

- Скрипт при каждом запуске выдаёт или релевантный список причин с ценой или сообщение о недоступности необходимых сервисов
#### 3.3. Подготовка пилота  

- Если есть готовый скрипт и БД с историческими данными, то для подготовки пилота достаточно просто запустить приложение.

### 4. Внедрение  

Текущая итерация:
1. ограничивается только деплоем streamlit приложения в облако
2. не предполагает разделения на production и не-production системы

Инструкция по деплою - будет добавлено позже

Инструмент предполагает использование 1 пользователем`PO`, поэтому нет необходимости учитывать пиковые нагрузки. 

Достаточно, чтобы приложение, развёрнутое в Streamlit Community Cloud успешно выполнялось менее, чем за час. Позже проверим на тестах.

Предполагается масштабирование системы, соответственно необходимо провести нагрузочное тестирование.
> ### Материалы для дополнительного погружения в тему  
> - [Шаблон ML System Design Doc [EN] от AWS](https://github.com/eugeneyan/ml-design-docs) и [статья](https://eugeneyan.com/writing/ml-design-docs/) с объяснением каждого раздела  
> - [Верхнеуровневый шаблон ML System Design Doc от Google](https://towardsdatascience.com/the-undeniable-importance-of-design-docs-to-data-scientists-421132561f3c) и [описание общих принципов его заполнения](https://towardsdatascience.com/understanding-design-docs-principles-for-achieving-data-scientists-53e6d5ad6f7e).
> - [ML Design Template](https://www.mle-interviews.com/ml-design-template) от ML Engineering Interviews  
> - Статья [Design Documents for ML Models](https://medium.com/people-ai-engineering/design-documents-for-ml-models-bbcd30402ff7) на Medium. Верхнеуровневые рекомендации по содержанию дизайн-документа и объяснение, зачем он вообще нужен  
> - [Краткий Canvas для ML-проекта от Made with ML](https://madewithml.com/courses/mlops/design/#timeline). Подходит для верхнеуровневого описания идеи, чтобы понять, имеет ли смысл идти дальше.  
